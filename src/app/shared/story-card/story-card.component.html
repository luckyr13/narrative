<mat-card
	class="post-card fadeIn mat-elevation-z0"
	[routerLink]="['/', profile && profile.username ? profile.username : post.owner, post.id]">
	<mat-card-content>
		<div class="card-content">
			<div class="avatar-container">
				<ngx-skeleton-loader 
						*ngIf="loadingProfile"
						[animation]="isDarkTheme ? 'progress-dark' : 'progress'"
						appearance="circle"
						[theme]="{ 'height.px': 62, 'width.px': 62, 'marginTop.px': 0 }"></ngx-skeleton-loader>
			  <img
			  	class="avatar"
			  	*ngIf="!loadingProfile"
			  	(click)="$event.stopPropagation()"
			  	[routerLink]="['/', profile ? profile.username : post.owner]"
			  	mat-card-avatar
			  	[src]="profileImage">
			</div>
			<div class="story-container">
				<h2 
					class="profile-name-container"
					*ngIf="!loadingProfile"
					(click)="$event.stopPropagation()"
					[routerLink]="['/', profile ? profile.username : post.owner]">
					<span *ngIf="profile && profile.name" class="ellipsis nowrap profile-name">{{ profile.name }}</span>
					<small *ngIf="profile && profile.username" class="profile-username">
						@{{ profile.username }}
					</small>
					<small *ngIf="post" class="profile-address">
						<app-arweave-address
							[address]="post.owner"
							[showCopyBtn]="false"
							[showOpenVieblockBtn]="false"
							[showVerifiedBtn]="true"
							class="address"></app-arweave-address>
					</small>
					<small *ngIf="post && post.blockTimestamp">
						Â· {{ post.blockTimestamp }}
					</small>
				</h2>
				<div class="profile-secondary-actions text-right">
					<button
						mat-icon-button
						(click)="$event.stopPropagation()"
						color="accent"
						aria-label="More options"
						[matMenuTriggerFor]="moreOptionsMenu">
	          <mat-icon>more_horiz</mat-icon>
	        </button>
	        <mat-menu #moreOptionsMenu="matMenu">
	        	<mat-list class="tx-info-container">
			        <mat-list-item>
			        	<h3 matLine>
			            TX Info
			          </h3>
			          <div matLine>
			            <app-arweave-address
			              [address]="post.id"
			              [isAddress]="false"
			              class="small-username-2">Id: </app-arweave-address>
			          </div>
			        </mat-list-item>
			      </mat-list>
					</mat-menu>
				</div>
				<ngx-skeleton-loader
					[animation]="isDarkTheme ? 'progress-dark' : 'progress'"
			  	appearance="line" 
			  	*ngIf="loadingProfile"
			  	[theme]="{ 'height.px': 22, 'width': '60%', 'marginBottom.px': 12, 'marginTop.px': 0 }"></ngx-skeleton-loader>
			  <ngx-skeleton-loader
					[animation]="isDarkTheme ? 'progress-dark' : 'progress'"
			  	appearance="line" 
			  	*ngIf="loadingContent"
			  	[theme]="{ 'height.px': 18, 'marginBottom.px': 8, 'marginTop.px': 0, 'width': '100%' }"></ngx-skeleton-loader>
			  <ngx-skeleton-loader
					[animation]="isDarkTheme ? 'progress-dark' : 'progress'"
			  	appearance="line" 
			  	*ngIf="loadingContent"
			  	[theme]="{ 'height.px': 18, 'marginBottom.px': 8, 'marginTop.px': 0, 'width': '100%' }"></ngx-skeleton-loader>
				<ngx-skeleton-loader
					[animation]="isDarkTheme ? 'progress-dark' : 'progress'"
			  	appearance="line" 
			  	*ngIf="loadingContent"
			  	[theme]="{ 'height.px': 18, 'marginBottom.px': 20, 'marginTop.px': 0, 'width': '90%' }"></ngx-skeleton-loader>
			  <!-- Story -->
			  <div 
			  	*ngIf="!loadingContent && content && !showStoryMoreTextBtn()"
			  	#contentContainer
			  	class="content fadeIn" [innerHTML]="content">
			  </div>
			  <!-- Preview -->
			  <div 
			  	*ngIf="!loadingContent && originalRawContent && showStoryMoreTextBtn()"
			  	#contentContainer
			  	class="content fadeIn">
			  	<p [innerHTML]="substr(originalRawContent, realPreviewSize)">

			  	</p>
			  	<div class="text-right">
			  		<button 
		        	mat-button
		        	class="btn-read-more"
		        	color="accent"
		        	*ngIf="realPreviewSize <= maxPreviewSize"
		        	(click)="readMore($event)"
		        	aria-label="Read more" matTooltip="Read more">
		        	Read more
			      </button>
			  	</div>
			  </div>
			  
			  <div 
			  	*ngIf="!loadingContent && contentError"
			  	#contentContainer
			  	class="content-error fadeIn">
			  	<span>
			  		{{ contentError }}
			  	</span>
			  	<button 
	        	mat-icon-button
	        	class="btn-open-anyway"
	        	(click)="openStory($event, post.id)"
	        	aria-label="Open in new window" matTooltip="Open in new window">
	        	<mat-icon class="material-icons-outlined">open_in_new</mat-icon>
		      </button>
			  </div>
			  <div class="clear-both" *ngIf="substories && substories.length">
			  	<app-story-player [substories]="substories"></app-story-player>
			  </div>
			  <div 
			  	*ngIf="post && (!post.blockId || post.blockHeight == 0) "
			  	class="fadeIn pending">
			  	<span>Pending TX</span>
			  	<mat-spinner class="" color="accent" diameter="26"></mat-spinner>
			  </div>
				
			</div>
		</div>
		 <div 
		  	*ngIf="!loadingContent && !(post && (!post.blockId || post.blockHeight == 0))"
		  	class="fadeIn story-actions">
		  	<div class="action-btn-wrapper">
	        <button 
	        	mat-button 
	        	class="blue-hover"
	        	(click)="comment($event)"
	        	aria-label="Comment">
		        <mat-icon class="material-icons-outlined">comment</mat-icon>
	        	<div>Comment</div>
		      </button>
	      </div>
		  	<div class="action-btn-wrapper">
		  		<button
		  			mat-button
		  			class="green-hover"
		  			(click)="repost($event)"
		  			aria-label="Repost">
		        <mat-icon class="material-icons-outlined">repeat</mat-icon>
		        <div>Repost</div>
		      </button>
		  	</div>
	      <div class="action-btn-wrapper">
	      	<button
	      		mat-button
	      		class="pink-hover"
	      		aria-label="Like"
	      		(click)="like($event)">
		        <mat-icon class="material-icons-outlined">favorite</mat-icon>
	        	<div>Like</div>
		      </button>
		  	</div>
	      <div class="action-btn-wrapper">
	      	<button
	      		mat-button
	      		class="orange-hover"
	      		aria-label="Share Story"
	      		(click)="share($event)">
		        <mat-icon class="material-icons-outlined">share</mat-icon>
	        	<div>Share</div>
		      </button>
		  	</div>
	      
		  </div>
	</mat-card-content>
	<mat-card-actions align="end">
		
	</mat-card-actions>
</mat-card>
<mat-divider></mat-divider>